<div class="modal-overlay" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">

    <div class="modal-header">
      <h2>Editar Paciente</h2>
      <button class="close-btnP" (click)="onClose()">&times;</button>
    </div>

    <form [formGroup]="editForm" (ngSubmit)="guardarCambios()">

      <div class="section-label">Información Personal</div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Nombre(s)</label>
          <input type="text" class="form-control" formControlName="nombre">
        </div>
        <div class="form-groupP">
          <label>Apellidos</label>
          <input type="text" class="form-control" formControlName="apellidos">
        </div>
      </div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Fecha de Nacimiento</label>
          <input type="date" class="form-control" formControlName="fecha_nacimiento">
        </div>

        <div class="form-groupP">
          <label>Sexo</label>
          <div class="chips-wrapper">
            <div class="chip-option" [class.selected]="editForm.get('sexo')?.value === 'Masculino'"
              (click)="setSexo('Masculino')">
              Masculino
            </div>
            <div class="chip-option" [class.selected]="editForm.get('sexo')?.value === 'Femenino'"
              (click)="setSexo('Femenino')">
              Femenino
            </div>
          </div>
          <input type="hidden" formControlName="sexo">
        </div>
      </div>

      <div class="section-label">Contacto</div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Teléfonos</label>
          <div formArrayName="telefonos" class="dynamic-list">
            <div *ngFor="let tel of telefonos.controls; let i = index" class="dynamic-item">
              <input type="text" class="form-control" [formControlName]="i" placeholder="Ej. 444 123 4567">
              <button type="button" class="btn-remove" (click)="removeTelefono(i)">&times;</button>
            </div>
          </div>
          <button type="button" class="btn-add-mini" (click)="addTelefono()">+ Agregar Teléfono</button>
        </div>

        <div class="form-groupP">
          <label>Correos Electrónicos</label>
          <div formArrayName="correos" class="dynamic-list">
            <div *ngFor="let mail of correos.controls; let i = index" class="dynamic-item">
              <input type="email" class="form-control" [formControlName]="i" placeholder="paciente@email.com">
              <button type="button" class="btn-remove" (click)="removeCorreo(i)">&times;</button>
            </div>
          </div>
          <button type="button" class="btn-add-mini" (click)="addCorreo()">+ Agregar Correo</button>
        </div>
      </div>

      <div class="section-label">Domicilio</div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Estado</label>
          <input type="text" class="form-control" formControlName="estado" readonly style="background: #f9f9f9;">
        </div>
        <div class="form-groupP">
          <label>Municipio</label>
          <input type="text" class="form-control" formControlName="municipio" readonly style="background: #f9f9f9;">
        </div>
      </div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Código Postal</label>
          <input type="text" class="form-control" formControlName="codigo_postal" (blur)="buscarCP()">
        </div>
        <div class="form-groupP">
          <label>Colonia</label>
          <select formControlName="colonia" class="form-control">
            <option value="">Seleccione una colonia</option>
            <option *ngFor="let c of colonias" [value]="c">{{ c }}</option>
          </select>
        </div>
      </div>

      <div class="form-row-2">
        <div class="form-groupP">
          <label>Calle</label>
          <input type="text" class="form-control" formControlName="calle">
        </div>
        <div class="form-groupP">
          <label>Número</label>
          <input type="text" class="form-control" formControlName="num">
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-cancel" (click)="onClose()">Cancelar</button>
        <button type="submit" class="btn-save">Guardar Cambios</button>
      </div>

    </form>
  </div>
</div>